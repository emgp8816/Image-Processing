%nombre=input('Ingrese el nombre de la imagen con su extensión:','s');
angulo=input('Angulo= ');

%imagen=imread(nombre);
imagen=imread('lineas20o50o60o120o130o150o.png');
gris=color2gris(imagen);
subplot(1,2,1),imshow(gris/255),title('Imagen original')

[a,b]=size(gris);
ddl=zeros(size(a-1,b-1));

switch angulo
   case 20 %1
    mask=[-1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1  8  8 -1;
          -1 -1  8  8  8  8  8 -1 -1;
          -1  8  8 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1];
     T=6120;
     case 50 %2
    mask=[-1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1  8  8;
          -1 -1 -1 -1 -1 -1  8 -1 -1;
          -1 -1 -1 -1 -1  8 -1 -1 -1;
          -1 -1 -1 -1  8 -1 -1 -1 -1;
          -1 -1 -1  8 -1 -1 -1 -1 -1;
          -1 -1  8 -1 -1 -1 -1 -1 -1;
          -1  8 -1 -1 -1 -1 -1 -1 -1;
           8 -1 -1 -1 -1 -1 -1 -1 -1];
    T=6500;
    case 60 %3
 mask=[-2 -2 -2 -2 -2  8 -2 -2 -2;
       -2 -2 -2 -2 -2  8 -2 -2 -2;
       -2 -2 -2 -2  8  8 -2 -2 -2;
       -2 -2 -2  8  8  8 -2 -2 -2;
       -2 -2 -2  8 16  8 -2 -2 -2;
       -2 -2 -2  8  8  8 -2 -2 -2;
       -2 -2 -2  8  8 -2 -2 -2 -2;
       -2 -2 -2  8 -2 -2 -2 -2 -2;
       -2 -2 -2  8 -2 -2 -2 -2 -2];
        T=10200;
        case 120 %4
   mask=[-2 -2 -2 -2 -2 -2 -2 -2 -2;
         -2 -2  8  8 -2 -2 -2 -2 -2;
         -2 -2  8  8  8 -2 -2 -2 -2;
         -2 -2 -2  8  8 -2 -2 -2 -2;
         -2 -2 -2 -2 32 -2 -2 -2 -2;
         -2 -2 -2 -2  8  8 -2 -2 -2;
         -2 -2 -2 -2  8  8  8 -2 -2;
         -2 -2 -2 -2 -2  8  8 -2 -2;
         -2 -2 -2 -2 -2 -2 -2 -2 -2];
        T=19100;
        case 150 %5
    mask=[-1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1;
           8 -1 -1 -1 -1 -1 -1 -1 -1;
          -1  8  8 -1 -1 -1 -1 -1 -1;
          -1 -1 -1  8  8  8 -1 -1 -1;
          -1 -1 -1 -1 -1 -1  8  8 -1;
          -1 -1 -1 -1 -1 -1 -1 -1  8;
          -1 -1 -1 -1 -1 -1 -1 -1 -1;
          -1 -1 -1 -1 -1 -1 -1 -1 -1];
   T=4600;   
   case 130 %6
   mask=[-1  4 -1 -1 -1 -1 -1 -1 -1;
         -1  4 -1 -1 -1 -1 -1 -1 -1;
         -1 -1  8 -1 -1 -1 -1 -1 -1;
         -1 -1 -1  8 -1 -1 -1 -1 -1;
         -1 -1 -1 -1 24 -1 -1 -1 -1;
         -1 -1 -1 -1 -1  8 -1 -1 -1;
         -1 -1 -1 -1 -1 -1  8 -1 -1;
         -1 -1 -1 -1 -1 -1 -1  4 -1;
         -1 -1 -1 -1 -1 -1 -1  4 -1];
     T=11200;
       otherwise
           disp('No se detectan lineas con ese ángulo');
           mask=zeros(9);
end


for i=5:a-4
        for j=5:b-4
            vecindad=mask.*gris(i-4:i+4,j-4:j+4);
            R=abs(floor(sum(vecindad(:))));
            if R >= T
                ddl(i-4,j-4)=255;
            else 
                ddl(i-4,j-4)=0;
            end
        end
end

 
str=sprintf('Linea a %d° grados',angulo);
subplot(1,2,2),imshow(ddl/255),title(str)